---
title: "Determinants of Soccer Players' Market Values in Major European Leagues"
subtitle: "A Comparative Linear Regression Analysis Across Five Leagues"
author: 
  - John Zhang
thanks: "Code and data are available at: https://github.com/Clearsky21z/Player_Market_Value_Analysis"
date: today
date-format: long
abstract: ""
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| echo: false
#| message: false
#| warning: false
library(arrow)
library(ggplot2)
library(dplyr)
library(modelsummary)
library(tidyverse)
library(knitr)
```


# Introduction{#sec-intro}
The global soccer transfer market is a dynamic and high-stakes environment where players’ market values are central to team-building strategies, investments, and negotiations. Understanding what drives these values is a critical question for analysts, clubs, and stakeholders. While common factors such as goals scored or club reputation are widely acknowledged to affect valuations, their relative importance likely varies across leagues with differing levels of competition, financial resources, and playing styles.

This paper focuses on five major European soccer leagues—Premier League(England), La Liga (Spain), Serie A (Italy), Bundesliga (Germany), and Ligue 1 (France). These leagues are not only among the most competitive but also vary in terms of audience size, financial backing, and player scouting pipelines, making them ideal for a comparative study of market value determinants.

Using player data from the 2023/24 season, this study develops league-specific linear regression models with market value as the dependent variable. Key predictors include age, goals, assists, club ranking, national team ranking, minutes played, and position. The analysis reveals both shared and league-specific patterns in the factors influencing market value. For instance, goals and assists consistently emerge as significant predictors, but their impact differs by league. Similarly, younger players tend to command higher valuations universally, with age effects most pronounced in Serie A.

These findings contribute to our understanding of how soccer markets function across different leagues and provide actionable insights for clubs and agents. The structure of this paper is as follows: Section 2 describes the dataset and variables, Section 3 outlines the modeling approach, Section 4 presents the results, and Section 5 discusses the implications and limitations of the findings.

# Data {#sec-data}

## Dataset Overview

The data includes information on players from the top five European leagues during the 2023/24 season. Variables of interest are:

- **Market Value**: Player’s estimated value in Euros.
- **Age**: Player age at the start of the season.
- **Goals and Assists**: Indicators of offensive contributions.
- **Club Ranking**: Rank of the player's club based on league and international performance.
- **National Team Ranking**: Ranking of the player's national team (1 to 210).
- **Minutes Played**: Total minutes played during the season.
- **Position**: Categorized as Defender (DF), Midfielder (MF), Forward (FW), and hybrids like FWDF.

## England

```{r}
#| echo: false
#| message: false
#| warning: false

# Load the dataset
england_data <- read_parquet("../data/02-analysis_data/cleaned_england_data.parquet")

# Scale down market value to millions
england_data <- england_data %>%
  mutate(market_value_million = market_value / 1e6)

# Individual plot for market value
england_market_value_plot <- ggplot(england_data, aes(x = market_value_million)) +
  geom_histogram(fill = "#D62728", color = "black", bins = 30) +
  theme_minimal() +
  labs(
    title = "Distribution of Market Value (in Million Euros)",
    x = "Market Value (Million Euros)",
    y = "Frequency"
  ) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

england_market_value_plot
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Reshape data for faceting (excluding market_value)
data_long <- england_data %>%
  select(
    age,
    goals,
    assists,
    club_ranking,
    national_team_ranking,
    minutes_played
  ) %>%
  pivot_longer(
    cols = everything(),
    names_to = "Variable",
    values_to = "Value"
  )

# Facet plot for the other variables
england_facet_plot <- ggplot(data_long, aes(x = Value)) +
  geom_histogram(fill = "#D62728", color = "black", bins = 30) +
  facet_wrap(~ Variable, nrow = 2, scales = "free") +
  theme_minimal() +
  labs(
    title = "Distribution of Other Variables",
    x = "Value",
    y = "Frequency"
  ) +
  theme(
    strip.text = element_text(size = 10, face = "bold"),
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )
england_facet_plot
```

## France

```{r}
#| echo: false
#| message: false
#| warning: false

# Load the dataset
france_data <- read_parquet("../data/02-analysis_data/cleaned_france_data.parquet")

# Scale down market value to millions
france_data <- france_data %>%
  mutate(market_value_million = market_value / 1e6)

# Individual plot for market value
france_market_value_plot <- ggplot(france_data, aes(x = market_value_million)) +
  geom_histogram(fill = "#1F77B4", color = "black", bins = 30) +
  theme_minimal() +
  labs(
    title = "Distribution of Market Value (in Million Euros)",
    x = "Market Value (Million Euros)",
    y = "Frequency"
  ) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

france_market_value_plot
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Reshape data for faceting (excluding market_value)
data_long <- france_data %>%
  select(
    age,
    goals,
    assists,
    club_ranking,
    national_team_ranking,
    minutes_played
  ) %>%
  pivot_longer(
    cols = everything(),
    names_to = "Variable",
    values_to = "Value"
  )

# Facet plot for the other variables
france_facet_plot <- ggplot(data_long, aes(x = Value)) +
  geom_histogram(fill = "#1F77B4", color = "black", bins = 30) +
  facet_wrap(~ Variable, nrow = 2, scales = "free") +
  theme_minimal() +
  labs(
    title = "Distribution of Other Variables",
    x = "Value",
    y = "Frequency"
  ) +
  theme(
    strip.text = element_text(size = 10, face = "bold"),
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )
france_facet_plot
```

## Germany

```{r}
#| echo: false
#| message: false
#| warning: false

# Load the dataset
germany_data <- read_parquet("../data/02-analysis_data/cleaned_germany_data.parquet")

# Scale down market value to millions
germany_data <- germany_data %>%
  mutate(market_value_million = market_value / 1e6)

# Individual plot for market value
germany_market_value_plot <- ggplot(germany_data, aes(x = market_value_million)) +
  geom_histogram(fill = "#000000", color = "white", bins = 30) +
  theme_minimal() +
  labs(
    title = "Distribution of Market Value (in Million Euros)",
    x = "Market Value (Million Euros)",
    y = "Frequency"
  ) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

germany_market_value_plot
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Reshape data for faceting (excluding market_value)
data_long <- germany_data %>%
  select(
    age,
    goals,
    assists,
    club_ranking,
    national_team_ranking,
    minutes_played
  ) %>%
  pivot_longer(
    cols = everything(),
    names_to = "Variable",
    values_to = "Value"
  )

# Facet plot for the other variables
germany_facet_plot <- ggplot(data_long, aes(x = Value)) +
  geom_histogram(fill = "#000000", color = "white", bins = 30) +
  facet_wrap(~ Variable, nrow = 2, scales = "free") +
  theme_minimal() +
  labs(
    title = "Distribution of Other Variables",
    x = "Value",
    y = "Frequency"
  ) +
  theme(
    strip.text = element_text(size = 10, face = "bold"),
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )
germany_facet_plot
```

## Italy

```{r}
#| echo: false
#| message: false
#| warning: false

# Load the dataset
italy_data <- read_parquet("../data/02-analysis_data/cleaned_italy_data.parquet")

# Scale down market value to millions
italy_data <- italy_data %>%
  mutate(market_value_million = market_value / 1e6)

# Individual plot for market value
italy_market_value_plot <- ggplot(italy_data, aes(x = market_value_million)) +
  geom_histogram(fill = "#2CA02C", color = "black", bins = 30) +
  theme_minimal() +
  labs(
    title = "Distribution of Market Value (in Million Euros)",
    x = "Market Value (Million Euros)",
    y = "Frequency"
  ) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

italy_market_value_plot
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Reshape data for faceting (excluding market_value)
data_long <- italy_data %>%
  select(
    age,
    goals,
    assists,
    club_ranking,
    national_team_ranking,
    minutes_played
  ) %>%
  pivot_longer(
    cols = everything(),
    names_to = "Variable",
    values_to = "Value"
  )

# Facet plot for the other variables
italy_facet_plot <- ggplot(data_long, aes(x = Value)) +
  geom_histogram(fill = "#2CA02C", color = "black", bins = 30) +
  facet_wrap(~ Variable, nrow = 2, scales = "free") +
  theme_minimal() +
  labs(
    title = "Distribution of Other Variables",
    x = "Value",
    y = "Frequency"
  ) +
  theme(
    strip.text = element_text(size = 10, face = "bold"),
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )
italy_facet_plot
```

## Spain

```{r}
#| echo: false
#| message: false
#| warning: false

# Load the dataset
spain_data <- read_parquet("../data/02-analysis_data/cleaned_spain_data.parquet")

# Scale down market value to millions
spain_data <- spain_data %>%
  mutate(market_value_million = market_value / 1e6)

# Individual plot for market value
spain_market_value_plot <- ggplot(spain_data, aes(x = market_value_million)) +
  geom_histogram(fill = "#FFB000", color = "black", bins = 30) +
  theme_minimal() +
  labs(
    title = "Distribution of Market Value (in Million Euros)",
    x = "Market Value (Million Euros)",
    y = "Frequency"
  ) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )

spain_market_value_plot
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Reshape data for faceting (excluding market_value)
data_long <- spain_data %>%
  select(
    age,
    goals,
    assists,
    club_ranking,
    national_team_ranking,
    minutes_played
  ) %>%
  pivot_longer(
    cols = everything(),
    names_to = "Variable",
    values_to = "Value"
  )

# Facet plot for the other variables
spain_facet_plot <- ggplot(data_long, aes(x = Value)) +
  geom_histogram(fill = "#FFB000", color = "black", bins = 30) +
  facet_wrap(~ Variable, nrow = 2, scales = "free") +
  theme_minimal() +
  labs(
    title = "Distribution of Other Variables",
    x = "Value",
    y = "Frequency"
  ) +
  theme(
    strip.text = element_text(size = 10, face = "bold"),
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )
spain_facet_plot
```

# Model {#sec-model}

A linear regression model was developed for each league:

$$
\begin{aligned}
\text{Market Value}_i &= \beta_0 + \beta_1 (\text{Age}_i) + \beta_2 (\text{Goals}_i) \\
&\quad + \beta_3 (\text{Assists}_i) + \beta_4 (\text{Club Ranking}_i) \\
&\quad + \beta_5 (\text{National Team Ranking}_i) + \beta_6 (\text{Minutes Played}_i) \\
&\quad + \beta_7 (\text{Position}_i) + \epsilon_i
\end{aligned}
$$


# Results {#sec-res}

## Regression Coefficients by League

The table below presents the key regression results for each league.

```{r}
#| echo: false
#| message: false
#| warning: false

# Load the regression results file
file_path <- "../models/player_market_value_models.csv"
final_results <- read_csv(file_path)

# Pivot data to create comparison tables
comparison_table <- final_results %>%
  select(term, estimate, League) %>%
  pivot_wider(names_from = League, values_from = estimate)

# Intercept comparison table
intercept_table <- comparison_table %>%
  filter(term == "(Intercept)") %>%
  select(-term)

# Display Intercept Table
kable(
  intercept_table,
  digits = 3,
  caption = "Intercept Estimates Across Leagues"
)
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Age comparison table
age_table <- comparison_table %>%
  filter(term == "age") %>%
  select(-term)

# Display Age Table
kable(
  age_table,
  digits = 3,
  caption = "Age Coefficient Estimates Across Leagues"
)
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Goals comparison table
goals_table <- comparison_table %>%
  filter(term == "goals") %>%
  select(-term)

# Display Goals Table
kable(
  goals_table,
  digits = 3,
  caption = "Goals Coefficient Estimates Across Leagues"
)
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Assists comparison table
assists_table <- comparison_table %>%
  filter(term == "assists") %>%
  select(-term)

# Display Assists Table
kable(
  assists_table,
  digits = 3,
  caption = "Assists Coefficient Estimates Across Leagues"
)
```

```{r}
#| echo: false
#| message: false
#| warning: false

# Club Ranking comparison table
club_ranking_table <- comparison_table %>%
  filter(term == "club_ranking") %>%
  select(-term)

# Display Club Ranking Table
kable(
  club_ranking_table,
  digits = 3,
  caption = "Club Ranking Coefficient Estimates Across Leagues"
)
```

## Key Findings

1. **Age**: Age negatively impacts market value across all leagues, with the effect strongest in Serie A and La Liga.
2. **Goals and Assists**: These variables are the most consistent predictors of market value. Their influence is largest in the Premier League, suggesting a higher emphasis on offensive contributions.
3. **Club Ranking**: Significant in all leagues, with stronger effects observed in Ligue 1 and Serie A.
4. **Position**: Forwards generally have lower valuations compared to midfielders and defenders in Ligue 1 and La Liga.

# Discussion {#sec-disc}

## What Was Done
This study developed league-specific linear regression models to analyze the determinants of soccer players’ market values.

## Insights Gained
1. Offensive contributions (goals, assists) are crucial drivers of market value, but their relative importance varies by league.
2. Club ranking is consistently significant, reflecting the role of team reputation in player valuation.
3. Age is negatively associated with market value, underscoring the premium placed on youth in professional soccer.

## Limitations and Future Directions
The study is limited to one season and excludes external factors like injuries, media influence, or tactical role. Future work could explore time-series data and non-linear modeling approaches.


\newpage

\appendix

# Appendix {#sec-appendix}

## Dataset and Graph Sketches

## Model Results

```{r}
#| echo: false
#| message: false
#| warning: false

# Load the regression results file
file_path <- "../models/player_market_value_models.csv"
final_results <- read_csv(file_path)

```


```{r}
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: "Regression Results for Premier League (England)"

# Filter results for the Premier League
england_results <- final_results %>%
  filter(League == "England")

# Simplify the results table
england_table <- england_results %>%
  select(term, estimate, std.error, p.value) %>%
  rename(
    Variable = term,
    Estimate = estimate,
    `Standard Error` = std.error,
    `P-Value` = p.value
  )

# Display the table with kable
kable(england_table, digits = 3, caption = "Regression Results for Premier League (England)")
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: "Regression Results for Ligue 1 (France)"

# Filter results for Ligue 1
france_results <- final_results %>%
  filter(League == "France")

# Simplify the results table
france_table <- france_results %>%
  select(term, estimate, std.error, p.value) %>%
  rename(
    Variable = term,
    Estimate = estimate,
    `Standard Error` = std.error,
    `P-Value` = p.value
  )

# Display the table with kable
kable(france_table, digits = 3, caption = "Regression Results for Ligue 1 (France)")
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: "Regression Results for Bundesliga (Germany)"

# Filter results for the Bundesliga
germany_results <- final_results %>%
  filter(League == "Germany")

# Simplify the results table
germany_table <- germany_results %>%
  select(term, estimate, std.error, p.value) %>%
  rename(
    Variable = term,
    Estimate = estimate,
    `Standard Error` = std.error,
    `P-Value` = p.value
  )

# Display the table with kable
kable(germany_table, digits = 3, caption = "Regression Results for Bundesliga (Germany)")
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: "Regression Results for Serie A (Italy)"

# Filter results for Serie A
italy_results <- final_results %>%
  filter(League == "Italy")

# Simplify the results table
italy_table <- italy_results %>%
  select(term, estimate, std.error, p.value) %>%
  rename(
    Variable = term,
    Estimate = estimate,
    `Standard Error` = std.error,
    `P-Value` = p.value
  )

# Display the table with kable
kable(italy_table, digits = 3, caption = "Regression Results for Serie A (Italy)")
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| tbl-cap: "Regression Results for La Liga (Spain)"

# Filter results for La Liga
spain_results <- final_results %>%
  filter(League == "Spain")

# Simplify the results table
spain_table <- spain_results %>%
  select(term, estimate, std.error, p.value) %>%
  rename(
    Variable = term,
    Estimate = estimate,
    `Standard Error` = std.error,
    `P-Value` = p.value
  )

# Display the table with kable
kable(spain_table, digits = 3, caption = "Regression Results for La Liga (Spain)")

```


# References
